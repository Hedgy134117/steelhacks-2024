<!DOCTYPE html>
<html>
  <head>
    <title>CS Courses Graph</title>
    <script
      type="text/javascript"
      src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"
    ></script>
    <style>
      #network {
        width: 100%;
        height: 700px;
        border: 1px solid lightgray;
      }
    </style>
  </head>
  <body>
    <div id="network"></div>

    <script>
      var courseData = {
        "CS 0004": "None",
        "CS 0007": "None",
        "CS 0008": "None",
        "CS 0010": "None",
        "CS 0011": "None",
        "CS 0012": "None",
        "CS 0015": "['MATH 0001']",
        "CS 0016": "None",
        "CS 0045": "None",
        "CS 0046": "None",
        "CS 0047": "None",
        "CS 0048": "None",
        "CS 0081": "None",
        "CS 0082": "None",
        "CS 0085": "None",
        "CS 0090": "None",
        "CS 0098": "None",
        "CS 0100": "None",
        "CS 0131": "None",
        "CS 0134": "None",
        "CS 0135": "['CS 0131']",
        "CS 0145": "None",
        "CS 0155":
          "['CS 0007', 'CS 0010', 'CS 0011', 'CS 0012', 'CMPINF 0401', 'CS 0401', 'CS 0417', 'CS 0457', 'CS 0422']",
        "CS 0180": "None",
        "CS 0207": "['INFSCI 0201', 'ECE 0301']",
        "CS 0241": "None",
        "CS 0245": "None",
        "CS 0251": "None",
        "CS 0334": "['CS 0007', 'CS 0134']",
        "CS 0401": "None",
        "CS 0405": "['MATH 0031']",
        "CS 0406": "['MATH 0401']",
        "CS 0410": "('CS 0100', 'MATH 0401')",
        "CS 0411": "('CS 0100', 'MATH 0401')",
        "CS 0417":
          "(('CS 0410', 'CS 0411'), ('CS 0015', 'CS 0016'), 'ET 0031', 'EE 0445')",
        "CS 0421": "['Math 0031']",
        "CS 0422": "['CS 0421']",
        "CS 0441": "None",
        "CS 0445":
          "['CMPINF 0401', 'CS 0401', 'COE 0401', 'CS 0422', 'CIST 0150', 'CS 0207']",
        "CS 0446": "None",
        "CS 0447": "['CS 0401', 'CS 0422']",
        "CS 0449": "['CS 0445', 'CS 0455']",
        "CS 0455":
          "(('CS 0410', 'CS 0411', 'CS 0406'), ('CS 0410', 'CS 0411', 'MATH 1012'), ('CS 0417', 'EE 0445'))",
        "CS 0456": "MISSING",
        "CS 0457":
          "(('CS 0455', 'CS 0456', 'CS 0045', 'CS 0046'), ('CS 0455', 'CS 0045'))",
        "CS 0458":
          "(('CS 0455', 'CS 0456', 'CS 0045', 'CS 0046'), ('CS 0455', 'CS 0045'))",
        "CS 0590":
          "['CS 0004', 'CS 0007', 'CS 0008', 'CS 0010', 'CS 0011', 'CS 0012', 'CS 0015', 'CS 0101', 'CS 0401', 'CMPINF 0401']",
        "CS 0699": "None",
        "CS 1132": "MISSING",
        "CS 1163": "MISSING",
        "CS 1164": "MISSING",
        "CS 1165": "['CS 1735']",
        "CS 1171": "None",
        "CS 1399": "None",
        "CS 1498": "None",
        "CS 1501":
          "(['CS 0441', 'CS 0406'], [['CS 0445', 'CS 0455', 'COE 0445'], ('CS 0245', 'CS 0207')])",
        "CS 1502":
          "(['CS 0441', 'CS 0406'], ['CS 0445', 'CS 0455', 'COE 0445'])",
        "CS 1503": "(['CS 0441', 'CS 0406'], ['MATH 0280', 'MATH 1180'])",
        "CS 1510":
          "((['CS 1501', 'COE 1501'], 'CS 1502'), ('CS 0458', 'CS 1710'))",
        "CS 1511": "['CS 1502']",
        "CS 1520": "['CS 0445', 'COE 0445']",
        "CS 1530": "['CS 0445', 'COE 0445']",
        "CS 1538":
          "('CS 0447', ['STAT 1000', 'CS 1100', 'CS 1151', 'MATH 1153'])",
        "CS 1541":
          "(['CS 0447', 'COE 0447', 'COE 0147'], ['CS 0449', 'COE 0449'])",
        "CS 1550":
          "(['CS 0447', 'COE 0447', 'COE 0147'], ['CS 0449', 'COE 0449'], ('CS 0456', 'CS 1750'))",
        "CS 1555": "['CS 1501']",
        "CS 1566": "['CS 0447', 'CS 0456', 'COE 0447', 'COE 0147']",
        "CS 1567":
          "(('CS 0441', ['CS 0445', 'COE 0445']), ('CS0406', 'CS 0455'))",
        "CS 1571": "(['CS 1501', 'COE 1501'], 'CS 1502')",
        "CS 1613": "('CS 1501', 'CS 1502')",
        "CS 1621": "(('CS 0441', 'CS 0445'), ('CS 0406', 'CS 0455'))",
        "CS 1622":
          "('CS 0441', [['CS/COE 0447', 'COE 0147'], ('CS 0406', 'CS 0456')])",
        "CS 1631": "(('CS 0441', ['CS/COE 0445']), ('CS 0406', 'CS 0455'))",
        "CS 1632": "None",
        "CS 1635": "['CS 0445']",
        "CS 1637": "None",
        "CS 1640": "('CS 1501', 'BIOSC 1540')",
        "CS 1645": "MISSING",
        "CS 1651": "['CS 1550', 'CS 1312', 'CS 1792']",
        "CS 1652":
          "(['CS 0447', 'COE 0447', 'COE 0147'], ['CS 0449', 'COE 0449'])",
        "CS 1653":
          "(['CS 0449', 'COE 0449'], ['CS 1501', 'COE 1501'], ['CS 0458', 'CS 1750'])",
        "CS 1655": "('CS 0441', ['CS 0445', 'COE 0445'])",
        "CS 1656": "['CS 1501', 'COE 1501']",
        "CS 1657": "('CS 0441', 'CS 1501')",
        "CS 1660": "['CS 1550']",
        "CS 1666": "['CS 1501', 'COE 1501']",
        "CS 1671": "['CS 1501']",
        "CS 1674": "['CS 1501', 'COE 1501']",
        "CS 1675":
          "('CS 1501', 'COE 1501', ['STAT 1000', 'CS 1100', 'CS 1151', 'ENGR 0020'])",
        "CS 1678": "None",
        "CS 1684": "None",
        "CS 1699": "None",
        "CS 1713": "MISSING",
        "CS 1720": "MISSING",
        "CS 1735": "MISSING",
        "CS 1736": "['CS 1735']",
        "CS 1760": "MISSING",
        "CS 1761": "('CS 0047', 'CS 0047', 'CS 0457', 'CS 0458')",
        "CS 1762": "MISSING",
        "CS 1765": "MISSING",
        "CS 1766": "MISSING",
        "CS 1783": "MISSING",
        "CS 1792": "MISSING",
        "CS 1900": "None",
        "CS 1901": "None",
        "CS 1902": "None",
        "CS 1903": "None",
        "CS 1904": "None",
        "CS 1906": "None",
        "CS 1950": "None",
        "CS 1951": "None",
        "CS 1980": "['CS 1550']",
      };

      function parsePrerequisites(prerequisites) {
        if (prerequisites === "None" || prerequisites === "MISSING")
          return null;
        try {
          // Replace single quotes with double quotes for JSON compatibility
          let cleaned = prerequisites
            .replace(/'/g, '"')
            .replace(/\(/g, "[")
            .replace(/\)/g, "]");
          return JSON.parse(cleaned);
        } catch (error) {
          console.error("Parsing error", error);
          return null;
        }
      }

      function buildGraphData(startCourse) {
        let nodes = [],
          edges = [];
        let visited = new Set();

        function traverse(course, parentId, relationship = "AND") {
          if (visited.has(course)) return;
          visited.add(course);

          nodes.push({ id: course, label: course });

          if (parentId !== null) {
            edges.push({
              from: course,
              to: parentId,
              dashes: relationship === "OR",
              arrows: "to",
            });
          }

          let prerequisites = parsePrerequisites(courseData[course]);
          if (prerequisites) {
            if (Array.isArray(prerequisites)) {
              prerequisites.forEach((prereq) => {
                if (typeof prereq === "string") {
                  traverse(prereq, course, "OR");
                } else if (Array.isArray(prereq)) {
                  prereq.forEach((subPrereq) =>
                    traverse(subPrereq, course, "AND")
                  );
                }
              });
            } else {
              traverse(prerequisites, course, "AND");
            }
          }
        }

        traverse(startCourse, null);

        return { nodes, edges };
      }

      function drawGraph(startCourse) {
        var { nodes, edges } = buildGraphData(startCourse);

        var container = document.getElementById("network");
        var data = {
          nodes: new vis.DataSet(nodes),
          edges: new vis.DataSet(edges),
        };
        var options = {
          layout: {
            hierarchical: {
              direction: "UD",
              sortMethod: "directed",
            },
          },
          edges: {
            smooth: {
              type: "curvedCW",
              roundness: 0.2,
            },
          },
        };
        new vis.Network(container, data, options);
      }

      // Example starting course
      drawGraph("CS 1980");
    </script>
  </body>
</html>
